---
title: "Examples With Peak Finder Script"
author: "Michael Olvera"
date: "September 8, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Using Peak Finder

This is a quick guide on how to use the Peak Finder script. Feel free to follow along with the code in this file to make sure everything is working well. For this file, R code is in boxes, and outputs are boxes with **##** before the code.

Before starting, include the following line of code at the top
of your script:

```{r source}
source("pf/peakFinder.R")
```

## Preprocessing

Samples must be preprocessed to be a dataframe with **Time**
included in column 1, and all other columns samples. A
preprocessed dataset is included in the zip folder:

```{r exampleData}
example <- read.csv('pf/data/CaHandUT1.csv')
head(example) # Prints first 6 rows
```

As a side note, make sure all of your comlumes are numeric/integers. A common mistake with R is that .csv
files are loaded with columns being factors. 

```{r exampleData2}
str(example)
```

As you can see above, all columns are of **type** numeric (**num**). Looking a the second row of the output, *$ Time* indicates the title of the column, then the datatype, followed by the first few data entries. 

## Analysis

The main functions are *runTest()* and *analyzeExperiemnt()*. You can call runTest() on you dataset to see how the function calls each peak.

```{r runTest1}
runTest(example[,c(1,3)]) #test only the second sample
```

Looks good. Lets look at our first sample.

```{r runTest2}
runTest(example[,1:2]) #test only the first sample
```

Looks like there is something wrong with the data. We can run another test on it to see whats going on. 

```{r detectRunError}
detectRunErrors(example[,2]) # No need to include 'Time'
```

Looks like timepoint 1025 failed to capture for whatever reason.  If we try to analyze this data, the program will catch it and ask if we want to include it in the analysis (we shouldn't).

```{r analyze1}
analyzeExperiment(example[,-2]) # Remove row 2
```

The output can be saved, and extracted to be used in Excel/Prism. 

Normally, you can run your whole dataframe in *analyzeExperiment*, and the program will find erorrs and ask you if they should be includede. But I cant show that here. 

If you have any questions or bugs, let me know (michael.olvera@gladstone.ucsf.edu).

```{r end}
sessionInfo() 
```
